
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Remote Compute &#8212; Contrail Tripleo queens documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Overcloud Installation" href="../installation.html" />
    <link rel="prev" title="Advanced vRouter SRIOV Mode Configurations" href="sriov.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="remote-compute">
<h1>Remote Compute<a class="headerlink" href="#remote-compute" title="Permalink to this headline">¶</a></h1>
<p>Remote Compute extends the data plane to remote locations (POP) whilest keeping the control plane central.
For Contrail, each POP will have its own set of Contrail control services, which are running in the central location.
The difficulty is to ensure that the compute nodes of a given POP connect to the Control nodes assigned to that POC.
The Control nodes must have predictable IP addresses and the compute nodes have to know these IP addresses.
In order to achieve that the following methods are used:</p>
<blockquote>
<div><ul class="simple">
<li>Static IP assignment</li>
<li>Precise Node placement</li>
<li>Per Node hieradata</li>
</ul>
</div></blockquote>
<p>Each overcloud node has a unique DMI UUID. This UUID is known on the undercloud as well as on the overcloud nodes. Hence, this UUID can be used for mapping node specific information.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<img alt="../../_images/remote_compute_overview.png" src="../../_images/remote_compute_overview.png" />
</div>
<div class="section" id="mapping-table">
<h2>Mapping table<a class="headerlink" href="#mapping-table" title="Permalink to this headline">¶</a></h2>
<p>+================================+=======================+======================================+======================================+========+===========+======+
| Nova Name                      | Ironic Name           | Ironic UUID                          | DMI UUID                             | KVM    | IP address| POP  |
+================================+=======================+======================================+======================================+========+===========+======+
<a href="#id1"><span class="problematic" id="id2">|</span></a>overcloud-contrailcontrolonly-0 | control-only-1-5b3s30 | 7d758dce-2784-45fd-be09-5a41eb53e764 | 73F8D030-E896-4A95-A9F5-E1A4FEBE322D | 5b3s30 | 10.0.0.11 | POP1 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+
<a href="#id3"><span class="problematic" id="id4">|</span></a>overcloud-contrailcontrolonly-1 | control-only-2-5b3s30 | d26abdeb-d514-4a37-a7fb-2cd2511c351f | 14639A66-D62C-4408-82EE-FDDC4E509687 | 5b3s30 | 10.0.0.14 | POP2 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+
<a href="#id5"><span class="problematic" id="id6">|</span></a>overcloud-contrailcontrolonly-2 | control-only-1-5b3s31 | 91dd9fa9-e8eb-4b51-8b5e-bbaffb6640e4 | 28AB0B57-D612-431E-B177-1C578AE0FEA4 | 5b3s31 | 10.0.0.12 | POP1 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+
<a href="#id7"><span class="problematic" id="id8">|</span></a>overcloud-contrailcontrolonly-3 | control-only-2-5b3s31 | 09fa57b8-580f-42ec-bf10-a19573521ed4 | 09BEC8CB-77E9-42A6-AFF4-6D4880FD87D0 | 5b3s31 | 10.0.0.15 | POP2 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+
<a href="#id9"><span class="problematic" id="id10">|</span></a>overcloud-contrailcontrolonly-4 | control-only-1-5b3s32 | f4766799-24c8-4e3b-af54-353f2b796ca4 | 3993957A-ECBF-4520-9F49-0AF6EE1667A7 | 5b3s32 | 10.0.0.13 | POP1 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+
<a href="#id11"><span class="problematic" id="id12">|</span></a>overcloud-contrailcontrolonly-5 | control-only-2-5b3s32 | 58a803ae-a785-470e-9789-139abbfa74fb | AF92F485-C30C-4D0A-BDC4-C6AE97D06A66 | 5b3s32 | 10.0.0.16 | POP2 |
+——————————–+———————–+————————————–+————————————–+——–+———–+——+</p>
</div>
<div class="section" id="controlonly-preparation">
<h2>ControlOnly preparation<a class="headerlink" href="#controlonly-preparation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-controlonly-overcloud-vms-to-overcloud-kvm-host">
<h3>Add ControlOnly Overcloud VMs to Overcloud KVM host<a class="headerlink" href="#add-controlonly-overcloud-vms-to-overcloud-kvm-host" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This has to be done on the Overcloud KVM hosts</p>
</div>
<p>On each of the Overcloud KVM hosts two ControlOnly Overcloud VM definitions will be created.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>ROLES=control-only:2
num=4
ipmi_user=ADMIN
ipmi_password=ADMIN
libvirt_path=/var/lib/libvirt/images
port_group=overcloud
prov_switch=br0

/bin/rm ironic_list
IFS=&#39;,&#39; read -ra role_list &lt;&lt;&lt; &quot;${ROLES}&quot;
for role in ${role_list[@]}; do
  role_name=`echo $role|cut -d &quot;:&quot; -f 1`
  role_count=`echo $role|cut -d &quot;:&quot; -f 2`
  for count in `seq 1 ${role_count}`; do
    echo $role_name $count
    qemu-img create -f qcow2 ${libvirt_path}/${role_name}_${count}.qcow2 99G
    virsh define /dev/stdin &lt;&lt;EOF
    $(virt-install --name ${role_name}_${count} \
--disk ${libvirt_path}/${role_name}_${count}.qcow2 \
--vcpus=4 \
--ram=16348 \
--network network=br0,model=virtio,portgroup=${port_group} \
--network network=br1,model=virtio \
--virt-type kvm \
--cpu host \
--import \
--os-variant rhel7 \
--serial pty \
--console pty,target_type=virtio \
--graphics vnc \
--print-xml)
EOF
    vbmc add ${role_name}_${count} --port 1623${num} --username ${ipmi_user} --password ${ipmi_password}
    vbmc start ${role_name}_${count}
    prov_mac=`virsh domiflist ${role_name}_${count}|grep ${prov_switch}|awk &#39;{print $5}&#39;`
    vm_name=${role_name}-${count}-`hostname -s`
    kvm_ip=`ip route get 1  |grep src |awk &#39;{print $7}&#39;`
    echo ${prov_mac} ${vm_name} ${kvm_ip} ${role_name} 1623${num}&gt;&gt; ironic_list
    num=$(expr $num + 1)
  done
done
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the generated ironic_list will be needed on the Undercloud to import the nodes to ironic</p>
</div>
</div>
<div class="section" id="import-controlonly-nodes-to-ironic">
<h3>Import ControlOnly nodes to ironic<a class="headerlink" href="#import-controlonly-nodes-to-ironic" title="Permalink to this headline">¶</a></h3>
<p>Get the ironic_lists from the Overcloud KVM hosts and combine them.</p>
<p>Examle:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">ironic_list_control_only</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">3</span><span class="n">a</span><span class="p">:</span><span class="mi">2</span><span class="n">f</span><span class="p">:</span><span class="n">ca</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.31</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16234</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">4</span><span class="n">f</span><span class="p">:</span><span class="mi">63</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.31</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16235</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">0</span><span class="n">c</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">74</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.32</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16234</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="n">ab</span><span class="p">:</span><span class="mi">55</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.32</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16235</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="n">c1</span><span class="p">:</span><span class="n">f0</span><span class="p">:</span><span class="mi">9</span><span class="n">a</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s32</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.33</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16234</span>
<span class="mi">52</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="n">f3</span><span class="p">:</span><span class="n">ce</span><span class="p">:</span><span class="mi">13</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s32</span> <span class="mf">10.87</span><span class="o">.</span><span class="mf">64.33</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="mi">16235</span>
</pre></div>
</div>
<p>Import</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>ipmi_password=ADMIN
ipmi_user=ADMIN

DEPLOY_KERNEL=$(openstack image show bm-deploy-kernel -f value -c id)
DEPLOY_RAMDISK=$(openstack image show bm-deploy-ramdisk -f value -c id)

num=0
while IFS= read -r line; do
  mac=`echo $line|awk &#39;{print $1}&#39;`
  name=`echo $line|awk &#39;{print $2}&#39;`
  kvm_ip=`echo $line|awk &#39;{print $3}&#39;`
  profile=`echo $line|awk &#39;{print $4}&#39;`
  ipmi_port=`echo $line|awk &#39;{print $5}&#39;`
  uuid=`openstack baremetal node create --driver ipmi \
                                        --property cpus=4 \
                                        --property memory_mb=16348 \
                                        --property local_gb=100 \
                                        --property cpu_arch=x86_64 \
                                        --driver-info ipmi_username=${ipmi_user}  \
                                        --driver-info ipmi_address=${kvm_ip} \
                                        --driver-info ipmi_password=${ipmi_password} \
                                        --driver-info ipmi_port=${ipmi_port} \
                                        --name=${name} \
                                        --property capabilities=node:contrail-control-only-${num},profile:${profile},boot_option:local \
                                        -c uuid -f value`
  openstack baremetal node set ${uuid} --driver-info deploy_kernel=$DEPLOY_KERNEL --driver-info deploy_ramdisk=$DEPLOY_RAMDISK
  openstack baremetal port create --node ${uuid} ${mac}
  openstack baremetal node manage ${uuid}
  num=$(expr $num + 1)
done &lt; &lt;(cat ironic_list_control_only)
</pre></div>
</div>
</div>
<div class="section" id="controlonly-node-introspection">
<h3>ControlOnly node introspection<a class="headerlink" href="#controlonly-node-introspection" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openstack</span> <span class="n">overcloud</span> <span class="n">node</span> <span class="n">introspect</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">manageable</span> <span class="o">--</span><span class="n">provide</span>
</pre></div>
</div>
</div>
<div class="section" id="controlonly-node-flavor-creation">
<h3>ControlOnly node flavor creation<a class="headerlink" href="#controlonly-node-flavor-creation" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openstack</span> <span class="n">flavor</span> <span class="n">create</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span> <span class="o">--</span><span class="n">ram</span> <span class="mi">4096</span> <span class="o">--</span><span class="n">vcpus</span> <span class="mi">1</span> <span class="o">--</span><span class="n">disk</span> <span class="mi">40</span>
<span class="n">openstack</span> <span class="n">flavor</span> <span class="nb">set</span> <span class="o">--</span><span class="nb">property</span> <span class="s2">&quot;capabilities:boot_option&quot;</span><span class="o">=</span><span class="s2">&quot;local&quot;</span> \
                     <span class="o">--</span><span class="nb">property</span> <span class="s2">&quot;capabilities:profile&quot;</span><span class="o">=</span><span class="s2">&quot;control-only&quot;</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span>
</pre></div>
</div>
</div>
<div class="section" id="static-ip-assignment">
<h3>Static IP assignment<a class="headerlink" href="#static-ip-assignment" title="Permalink to this headline">¶</a></h3>
<p>Control Only nodes must have static IPs assigned</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">ips</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">pool</span><span class="o">-</span><span class="nb">all</span><span class="o">.</span><span class="n">yaml</span>
<span class="c1"># Environment file demonstrating how to pre-assign IPs to all node types</span>
<span class="n">resource_registry</span><span class="p">:</span>
  <span class="n">OS</span><span class="p">::</span><span class="n">TripleO</span><span class="p">::</span><span class="n">ContrailControlOnly</span><span class="p">::</span><span class="n">Ports</span><span class="p">::</span><span class="n">InternalApiPort</span><span class="p">:</span> <span class="o">../../</span><span class="n">network</span><span class="o">/</span><span class="n">ports</span><span class="o">/</span><span class="n">internal_api_from_pool</span><span class="o">.</span><span class="n">yaml</span>
  <span class="n">OS</span><span class="p">::</span><span class="n">TripleO</span><span class="p">::</span><span class="n">ContrailControlOnly</span><span class="p">::</span><span class="n">Ports</span><span class="p">::</span><span class="n">TenantPort</span><span class="p">:</span> <span class="o">../../</span><span class="n">network</span><span class="o">/</span><span class="n">ports</span><span class="o">/</span><span class="n">tenant_from_pool</span><span class="o">.</span><span class="n">yaml</span>
  <span class="c1"># Management network is optional and disabled by default</span>
  <span class="c1">#OS::TripleO::Controller::Ports::ManagementPort: ../network/ports/management_from_pool.yaml</span>

<span class="n">parameter_defaults</span><span class="p">:</span>
  <span class="n">ContrailControlOnlyIPs</span><span class="p">:</span>
    <span class="n">internal_api</span><span class="p">:</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.11</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.14</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.12</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.15</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.13</span>
    <span class="o">-</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">0.16</span>
    <span class="n">tenant</span><span class="p">:</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.11</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.14</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.12</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.15</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.13</span>
    <span class="o">-</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.16</span>
</pre></div>
</div>
</div>
<div class="section" id="create-scheduler-hints">
<h3>Create scheduler hints<a class="headerlink" href="#create-scheduler-hints" title="Permalink to this headline">¶</a></h3>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">scheduler</span><span class="o">-</span><span class="n">hints</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">parameter_defaults</span><span class="p">:</span>
 <span class="n">ContrailControlOnlySchedulerHints</span><span class="p">:</span>
     <span class="s1">&#39;capabilities:node&#39;</span><span class="p">:</span> <span class="s1">&#39;contrail-control-only-</span><span class="si">%i</span><span class="s1">ndex%&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="create-subcluser-nodedata">
<h3>Create subcluser nodedata<a class="headerlink" href="#create-subcluser-nodedata" title="Permalink to this headline">¶</a></h3>
<div class="section" id="get-the-ironic-uuid-of-the-controlonly-nodes">
<h4>Get the ironic UUID of the ControlOnly nodes<a class="headerlink" href="#get-the-ironic-uuid-of-the-controlonly-nodes" title="Permalink to this headline">¶</a></h4>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openstack</span> <span class="n">baremetal</span> <span class="n">node</span> <span class="nb">list</span> <span class="o">|</span><span class="n">grep</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span>
<span class="o">|</span> <span class="mi">7</span><span class="n">d758dce</span><span class="o">-</span><span class="mi">2784</span><span class="o">-</span><span class="mi">45</span><span class="n">fd</span><span class="o">-</span><span class="n">be09</span><span class="o">-</span><span class="mi">5</span><span class="n">a41eb53e764</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">d26abdeb</span><span class="o">-</span><span class="n">d514</span><span class="o">-</span><span class="mi">4</span><span class="n">a37</span><span class="o">-</span><span class="n">a7fb</span><span class="o">-</span><span class="mi">2</span><span class="n">cd2511c351f</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">91</span><span class="n">dd9fa9</span><span class="o">-</span><span class="n">e8eb</span><span class="o">-</span><span class="mi">4</span><span class="n">b51</span><span class="o">-</span><span class="mi">8</span><span class="n">b5e</span><span class="o">-</span><span class="n">bbaffb6640e4</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">09</span><span class="n">fa57b8</span><span class="o">-</span><span class="mi">580</span><span class="n">f</span><span class="o">-</span><span class="mi">42</span><span class="n">ec</span><span class="o">-</span><span class="n">bf10</span><span class="o">-</span><span class="n">a19573521ed4</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">f4766799</span><span class="o">-</span><span class="mi">24</span><span class="n">c8</span><span class="o">-</span><span class="mf">4e3</span><span class="n">b</span><span class="o">-</span><span class="n">af54</span><span class="o">-</span><span class="mi">353</span><span class="n">f2b796ca4</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s32</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">58</span><span class="n">a803ae</span><span class="o">-</span><span class="n">a785</span><span class="o">-</span><span class="mf">470e-9789</span><span class="o">-</span><span class="mi">139</span><span class="n">abbfa74fb</span> <span class="o">|</span> <span class="n">control</span><span class="o">-</span><span class="n">only</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s32</span>  <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
</pre></div>
</div>
<p>The first ControlOnly node on each of the Overcloud KVM hosts will be used for POP1, the second for POP2</p>
</div>
<div class="section" id="get-the-ironic-uuid-of-the-pop-compute-nodes">
<h4>Get the ironic UUID of the POP compute nodes<a class="headerlink" href="#get-the-ironic-uuid-of-the-pop-compute-nodes" title="Permalink to this headline">¶</a></h4>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openstack</span> <span class="n">baremetal</span> <span class="n">node</span> <span class="nb">list</span> <span class="o">|</span><span class="n">grep</span> <span class="n">compute</span>
<span class="o">|</span> <span class="mi">91</span><span class="n">d6026c</span><span class="o">-</span><span class="n">b9db</span><span class="o">-</span><span class="mi">49</span><span class="n">cb</span><span class="o">-</span><span class="n">a685</span><span class="o">-</span><span class="mi">99</span><span class="n">a63da5d81e</span> <span class="o">|</span> <span class="n">compute</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">8028</span><span class="n">eb8c</span><span class="o">-</span><span class="n">e1e6</span><span class="o">-</span><span class="mi">4357</span><span class="o">-</span><span class="mi">8</span><span class="n">fcf</span><span class="o">-</span><span class="mi">0796778</span><span class="n">bd2f7</span> <span class="o">|</span> <span class="n">compute</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s30</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">b795b3b9</span><span class="o">-</span><span class="n">c4e3</span><span class="o">-</span><span class="mi">4</span><span class="n">a76</span><span class="o">-</span><span class="mi">90</span><span class="n">af</span><span class="o">-</span><span class="mi">258</span><span class="n">d9336d9fb</span> <span class="o">|</span> <span class="n">compute</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
<span class="o">|</span> <span class="mi">2</span><span class="n">d4be83e</span><span class="o">-</span><span class="mi">6</span><span class="n">fcc</span><span class="o">-</span><span class="mi">4761</span><span class="o">-</span><span class="mi">86</span><span class="n">f2</span><span class="o">-</span><span class="n">c2615dd15074</span> <span class="o">|</span> <span class="n">compute</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">5</span><span class="n">b3s31</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">power</span> <span class="n">off</span> <span class="o">|</span> <span class="n">available</span> <span class="o">|</span> <span class="kc">False</span> <span class="o">|</span>
</pre></div>
</div>
<p>From that list the first two compute nodes belong to POP1 the rest to POP2</p>
</div>
<div class="section" id="create-an-input-yaml">
<h4>Create an input yaml<a class="headerlink" href="#create-an-input-yaml" title="Permalink to this headline">¶</a></h4>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="o">~/</span><span class="n">subcluster_input</span><span class="o">.</span><span class="n">yaml</span>
<span class="o">---</span>
<span class="o">-</span> <span class="n">subcluster</span><span class="p">:</span> <span class="n">subcluster1</span>
  <span class="n">asn</span><span class="p">:</span> <span class="s2">&quot;65413&quot;</span>
  <span class="n">control_nodes</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">7</span><span class="n">d758dce</span><span class="o">-</span><span class="mi">2784</span><span class="o">-</span><span class="mi">45</span><span class="n">fd</span><span class="o">-</span><span class="n">be09</span><span class="o">-</span><span class="mi">5</span><span class="n">a41eb53e764</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.11</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">91</span><span class="n">dd9fa9</span><span class="o">-</span><span class="n">e8eb</span><span class="o">-</span><span class="mi">4</span><span class="n">b51</span><span class="o">-</span><span class="mi">8</span><span class="n">b5e</span><span class="o">-</span><span class="n">bbaffb6640e4</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.12</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="n">f4766799</span><span class="o">-</span><span class="mi">24</span><span class="n">c8</span><span class="o">-</span><span class="mf">4e3</span><span class="n">b</span><span class="o">-</span><span class="n">af54</span><span class="o">-</span><span class="mi">353</span><span class="n">f2b796ca4</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.13</span>
  <span class="n">compute_nodes</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">91</span><span class="n">d6026c</span><span class="o">-</span><span class="n">b9db</span><span class="o">-</span><span class="mi">49</span><span class="n">cb</span><span class="o">-</span><span class="n">a685</span><span class="o">-</span><span class="mi">99</span><span class="n">a63da5d81e</span>
      <span class="n">vrouter_gateway</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">8028</span><span class="n">eb8c</span><span class="o">-</span><span class="n">e1e6</span><span class="o">-</span><span class="mi">4357</span><span class="o">-</span><span class="mi">8</span><span class="n">fcf</span><span class="o">-</span><span class="mi">0796778</span><span class="n">bd2f7</span>
      <span class="n">vrouter_gateway</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
<span class="o">-</span> <span class="n">subcluster</span><span class="p">:</span> <span class="n">subcluster2</span>
  <span class="n">asn</span><span class="p">:</span> <span class="s2">&quot;65414&quot;</span>
  <span class="n">control_nodes</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="n">d26abdeb</span><span class="o">-</span><span class="n">d514</span><span class="o">-</span><span class="mi">4</span><span class="n">a37</span><span class="o">-</span><span class="n">a7fb</span><span class="o">-</span><span class="mi">2</span><span class="n">cd2511c351f</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.14</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">09</span><span class="n">fa57b8</span><span class="o">-</span><span class="mi">580</span><span class="n">f</span><span class="o">-</span><span class="mi">42</span><span class="n">ec</span><span class="o">-</span><span class="n">bf10</span><span class="o">-</span><span class="n">a19573521ed4</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.15</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">58</span><span class="n">a803ae</span><span class="o">-</span><span class="n">a785</span><span class="o">-</span><span class="mf">470e-9789</span><span class="o">-</span><span class="mi">139</span><span class="n">abbfa74fb</span>
      <span class="n">ipaddress</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.16</span>
  <span class="n">compute_nodes</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="n">b795b3b9</span><span class="o">-</span><span class="n">c4e3</span><span class="o">-</span><span class="mi">4</span><span class="n">a76</span><span class="o">-</span><span class="mi">90</span><span class="n">af</span><span class="o">-</span><span class="mi">258</span><span class="n">d9336d9fb</span>
      <span class="n">vrouter_gateway</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
    <span class="o">-</span> <span class="n">uuid</span><span class="p">:</span> <span class="mi">2</span><span class="n">d4be83e</span><span class="o">-</span><span class="mi">6</span><span class="n">fcc</span><span class="o">-</span><span class="mi">4761</span><span class="o">-</span><span class="mi">86</span><span class="n">f2</span><span class="o">-</span><span class="n">c2615dd15074</span>
      <span class="n">vrouter_gateway</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-subcluster-environment-file">
<h4>Generate subcluster environment file<a class="headerlink" href="#generate-subcluster-environment-file" title="Permalink to this headline">¶</a></h4>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">subcluster</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">i</span> <span class="o">~/</span><span class="n">subcluster_input</span><span class="o">.</span><span class="n">yaml</span> \
               <span class="o">-</span><span class="n">o</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">subcluster</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
</div>
<div class="section" id="check-subcluster-environment-file">
<h4>Check subcluster environment file<a class="headerlink" href="#check-subcluster-environment-file" title="Permalink to this headline">¶</a></h4>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">subcluster</span><span class="o">.</span><span class="n">yaml</span>
<span class="n">parameter_defaults</span><span class="p">:</span>
  <span class="n">NodeDataLookup</span><span class="p">:</span>
    <span class="mi">041</span><span class="n">D7B75</span><span class="o">-</span><span class="mi">6581</span><span class="o">-</span><span class="mi">41</span><span class="n">B3</span><span class="o">-</span><span class="mi">886</span><span class="n">E</span><span class="o">-</span><span class="n">C06847B9C87E</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">CONTROL_NODES</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.14</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.16</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster2</span>
        <span class="n">VROUTER_GATEWAY</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
    <span class="mi">09</span><span class="n">BEC8CB</span><span class="o">-</span><span class="mf">77E9</span><span class="o">-</span><span class="mi">42</span><span class="n">A6</span><span class="o">-</span><span class="n">AFF4</span><span class="o">-</span><span class="mi">6</span><span class="n">D4880FD87D0</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65414&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster2</span>
    <span class="mi">14639</span><span class="n">A66</span><span class="o">-</span><span class="n">D62C</span><span class="o">-</span><span class="mi">4408</span><span class="o">-</span><span class="mi">82</span><span class="n">EE</span><span class="o">-</span><span class="n">FDDC4E509687</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65414&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster2</span>
    <span class="mi">28</span><span class="n">AB0B57</span><span class="o">-</span><span class="n">D612</span><span class="o">-</span><span class="mi">431</span><span class="n">E</span><span class="o">-</span><span class="n">B177</span><span class="o">-</span><span class="mi">1</span><span class="n">C578AE0FEA4</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65413&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster1</span>
    <span class="mi">3993957</span><span class="n">A</span><span class="o">-</span><span class="n">ECBF</span><span class="o">-</span><span class="mi">4520</span><span class="o">-</span><span class="mi">9</span><span class="n">F49</span><span class="o">-</span><span class="mi">0</span><span class="n">AF6EE1667A7</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65413&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster1</span>
    <span class="mi">73</span><span class="n">F8D030</span><span class="o">-</span><span class="n">E896</span><span class="o">-</span><span class="mi">4</span><span class="n">A95</span><span class="o">-</span><span class="n">A9F5</span><span class="o">-</span><span class="n">E1A4FEBE322D</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65413&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster1</span>
    <span class="mi">7933</span><span class="n">C2D8</span><span class="o">-</span><span class="n">E61E</span><span class="o">-</span><span class="mi">4752</span><span class="o">-</span><span class="mi">854</span><span class="n">E</span><span class="o">-</span><span class="n">B7B18A424971</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">CONTROL_NODES</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.14</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.16</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster2</span>
        <span class="n">VROUTER_GATEWAY</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
    <span class="n">AF92F485</span><span class="o">-</span><span class="n">C30C</span><span class="o">-</span><span class="mi">4</span><span class="n">D0A</span><span class="o">-</span><span class="n">BDC4</span><span class="o">-</span><span class="n">C6AE97D06A66</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">BGP_ASN</span><span class="p">:</span> <span class="s1">&#39;65414&#39;</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster2</span>
    <span class="n">BB9E9D00</span><span class="o">-</span><span class="mi">57</span><span class="n">D1</span><span class="o">-</span><span class="mi">410</span><span class="n">B</span><span class="o">-</span><span class="mi">8</span><span class="n">B19</span><span class="o">-</span><span class="mi">17</span><span class="n">A0DA581044</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">CONTROL_NODES</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.13</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster1</span>
        <span class="n">VROUTER_GATEWAY</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
    <span class="n">E1A809DE</span><span class="o">-</span><span class="n">FDB2</span><span class="o">-</span><span class="mi">4</span><span class="n">EB2</span><span class="o">-</span><span class="n">A91F</span><span class="o">-</span><span class="mi">1</span><span class="n">B3F75B99510</span><span class="p">:</span>
      <span class="n">contrail_settings</span><span class="p">:</span>
        <span class="n">CONTROL_NODES</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.11</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.13</span>
        <span class="n">SUBCLUSTER</span><span class="p">:</span> <span class="n">subcluster1</span>
        <span class="n">VROUTER_GATEWAY</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="deployment">
<h3>Deployment<a class="headerlink" href="#deployment" title="Permalink to this headline">¶</a></h3>
<p>Add contrail-subcluster.yaml, contrail-ips-from-pool-all.yaml and contrail-scheduler-hints.yaml to the openstack deploy command:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">openstack</span> <span class="n">overcloud</span> <span class="n">deploy</span> <span class="o">--</span><span class="n">templates</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">overcloud_images</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">isolation</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">plugins</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">services</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">net</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">subcluster</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">ips</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">pool</span><span class="o">-</span><span class="nb">all</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">-</span><span class="n">e</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">environments</span><span class="o">/</span><span class="n">contrail</span><span class="o">/</span><span class="n">contrail</span><span class="o">-</span><span class="n">scheduler</span><span class="o">-</span><span class="n">hints</span><span class="o">.</span><span class="n">yaml</span> \
 <span class="o">--</span><span class="n">roles</span><span class="o">-</span><span class="n">file</span> <span class="o">~/</span><span class="n">tripleo</span><span class="o">-</span><span class="n">heat</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">roles_data_contrail_aio</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Remote Compute</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#mapping-table">Mapping table</a></li>
<li><a class="reference internal" href="#controlonly-preparation">ControlOnly preparation</a><ul>
<li><a class="reference internal" href="#add-controlonly-overcloud-vms-to-overcloud-kvm-host">Add ControlOnly Overcloud VMs to Overcloud KVM host</a></li>
<li><a class="reference internal" href="#import-controlonly-nodes-to-ironic">Import ControlOnly nodes to ironic</a></li>
<li><a class="reference internal" href="#controlonly-node-introspection">ControlOnly node introspection</a></li>
<li><a class="reference internal" href="#controlonly-node-flavor-creation">ControlOnly node flavor creation</a></li>
<li><a class="reference internal" href="#static-ip-assignment">Static IP assignment</a></li>
<li><a class="reference internal" href="#create-scheduler-hints">Create scheduler hints</a></li>
<li><a class="reference internal" href="#create-subcluser-nodedata">Create subcluser nodedata</a><ul>
<li><a class="reference internal" href="#get-the-ironic-uuid-of-the-controlonly-nodes">Get the ironic UUID of the ControlOnly nodes</a></li>
<li><a class="reference internal" href="#get-the-ironic-uuid-of-the-pop-compute-nodes">Get the ironic UUID of the POP compute nodes</a></li>
<li><a class="reference internal" href="#create-an-input-yaml">Create an input yaml</a></li>
<li><a class="reference internal" href="#generate-subcluster-environment-file">Generate subcluster environment file</a></li>
<li><a class="reference internal" href="#check-subcluster-environment-file">Check subcluster environment file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#deployment">Deployment</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../templates.html">Templates</a><ul>
      <li>Previous: <a href="sriov.html" title="previous chapter">Advanced vRouter SRIOV Mode Configurations</a></li>
      <li>Next: <a href="../installation.html" title="next chapter">Overcloud Installation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/overcloud/advanced/remotecompute.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Michael Henkel.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../../_sources/overcloud/advanced/remotecompute.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>