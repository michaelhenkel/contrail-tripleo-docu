<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Environment Setup &mdash; tripleo-docs 0.0.1.dev17 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1.dev17',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/cookies.js"></script>
    <script type="text/javascript" src="../_static/expandable.js"></script>
    <script type="text/javascript" src="../_static/admonition_selector.js"></script>
    <script type="text/javascript" src="../_static/jquery.scrollTo.js"></script>
    <script type="text/javascript" src="../_static/jquery.nav.js"></script>
    <script type="text/javascript" src="../_static/menu.js"></script>
    <link rel="top" title="tripleo-docs 0.0.1.dev17 documentation" href="../index.html" />
    <link rel="next" title="Undercloud Installation" href="../installation/installation.html" />
    <link rel="prev" title="TripleO Components" href="../introduction/components.html" /> 
  </head>
  <body>
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="environment-setup">
<h1>Environment Setup<a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h1>
<p>TripleO can be used in baremetal as well as in virtual environments. This
section contains instructions on how to setup your environments properly.</p>
<div class="section" id="virtual-environment">
<h2>Virtual Environment<a class="headerlink" href="#virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>TripleO can be used in a virtual environment using virtual machines instead
of actual baremetal. However, one baremetal machine is still
needed to act as the host for the virtual machines.</p>
<div class="section" id="minimum-system-requirements">
<h3>Minimum System Requirements<a class="headerlink" href="#minimum-system-requirements" title="Permalink to this headline">¶</a></h3>
<p>By default, this setup creates 3 virtual machines:</p>
<ul class="simple">
<li>1 Undercloud</li>
<li>1 Overcloud Controller</li>
<li>1 Overcloud Compute</li>
</ul>
<p>Each virtual machine must consist of at least 4 GB of memory and 40 GB of disk
space <a class="footnote-reference" href="#id3" id="id1">[1]</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The virtual machine disk files are thinly provisioned and will not take up
the full 40GB initially.</p>
</div>
<p>The baremetal machine must meet the following minimum system requirements:</p>
<ul class="simple">
<li>Virtualization hardware extensions enabled (nested KVM is <strong>not</strong> supported)</li>
<li>1 quad core CPU</li>
<li>12 GB free memory</li>
<li>120 GB disk space</li>
</ul>
<p>TripleO currently supports the following operating systems:</p>
<ul class="simple">
<li>RHEL 7.1 x86_64 or</li>
<li>CentOS 7 x86_64</li>
</ul>
</div>
<div class="section" id="preparing-the-virtual-environment-automated">
<span id="preparing-virtual-environment"></span><h3>Preparing the Virtual Environment (Automated)<a class="headerlink" href="#preparing-the-virtual-environment-automated" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Install RHEL 7.1 Server x86_64 or CentOS 7 x86_64 on your host machine.</li>
</ol>
<blockquote>
<div><div class="portal admonition">
<p class="first admonition-title">RHEL Portal Registration</p>
<p>Register the host machine using Subscription Management.:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>sudo subscription-manager register --username=&quot;[your username]&quot; --password=&quot;[your password]&quot;
# Find this with `subscription-manager list --available`
sudo subscription-manager attach --pool=&quot;[pool id]&quot;
# Verify repositories are available
sudo subscription-manager repos --list
# Enable repositories needed
sudo subscription-manager repos --enable=rhel-7-server-rpms \
     --enable=rhel-7-server-optional-rpms --enable=rhel-7-server-extras-rpms \
     --enable=rhel-7-server-openstack-6.0-rpms
</pre></div>
</div>
</div>
<div class="satellite admonition">
<p class="first admonition-title">RHEL Satellite Registration</p>
<p>To register the host machine to a Satellite, the following repos must
be synchronized on the Satellite:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">optional</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">extras</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="mf">6.0</span><span class="o">-</span><span class="n">rpms</span>
</pre></div>
</div>
<p class="last">See the <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Satellite/">Red Hat Satellite User Guide</a> for how to configure the system to
register with a Satellite server. It is suggested to use an activation
key that automatically enables the above repos for registered systems.</p>
</div>
</div></blockquote>
<ol class="arabic">
<li><p class="first">Make sure sshd service is installed and running.</p>
</li>
<li><p class="first">The user performing all of the installation steps on the virt host needs to
have sudo enabled. You can use an existing user or use the following commands
to create a new user called stack with password-less sudo enabled. Do not run
the rest of the steps in this guide as root.</p>
<ul>
<li><p class="first">Example commands to create a user:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo useradd stack
sudo passwd stack  # specify a password
echo &quot;stack ALL=(root) NOPASSWD:ALL&quot; | sudo tee -a /etc/sudoers.d/stack
sudo chmod 0440 /etc/sudoers.d/stack
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Make sure you are logged in as the non-root user you intend to use.</p>
<ul>
<li><p class="first">Example command to log in as the non-root user:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">su</span> <span class="o">-</span> <span class="n">stack</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Enable needed repositories:</p>
</li>
</ol>
<blockquote>
<div><p>Enable epel:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo yum -y install epel-release
</pre></div>
</div>
</div></blockquote>
<blockquote>
<div><p>Enable last known good RDO Trunk Delorean repository for core openstack packages</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo curl -o /etc/yum.repos.d/delorean.repo http://trunk.rdoproject.org/centos7/current-tripleo/delorean.repo
</pre></div>
</div>
<p>Enable latest RDO Trunk Delorean repository only for the TripleO packages</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo curl -o /etc/yum.repos.d/delorean-current.repo http://trunk.rdoproject.org/centos7/current/delorean.repo
sudo sed -i &#39;s/\[delorean\]/\[delorean-current\]/&#39; /etc/yum.repos.d/delorean-current.repo
sudo /bin/bash -c &quot;cat &lt;&lt;EOF&gt;&gt;/etc/yum.repos.d/delorean-current.repo

includepkgs=diskimage-builder,instack,instack-undercloud,os-apply-config,os-cloud-config,os-collect-config,os-net-config,os-refresh-config,python-tripleoclient,tripleo-common,openstack-tripleo-heat-templates,openstack-tripleo-image-elements,openstack-tripleo,openstack-tripleo-puppet-elements,openstack-puppet-modules
EOF&quot;
</pre></div>
</div>
<p>Enable the Delorean Deps repository</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo curl -o /etc/yum.repos.d/delorean-deps.repo http://trunk.rdoproject.org/centos7/delorean-deps.repo
</pre></div>
</div>
<div class="stable admonition">
<p class="first admonition-title">Stable Branch</p>
<p><em>Skip all repos mentioned above, other than epel-release which is still required.</em></p>
<p>Enable latest RDO Stable Delorean repository for all packages</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo curl -o /etc/yum.repos.d/delorean-liberty.repo https://trunk.rdoproject.org/centos7-liberty/current/delorean.repo
</pre></div>
</div>
<p>Enable the Delorean Deps repository</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>sudo curl -o /etc/yum.repos.d/delorean-deps-liberty.repo http://trunk.rdoproject.org/centos7-liberty/delorean-deps.repo
</pre></div>
</div>
</div>
</div></blockquote>
<ol class="arabic" start="5">
<li><p class="first">Install instack-undercloud:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo yum install -y instack-undercloud
</pre></div>
</div>
</li>
<li><p class="first">The virt setup automatically sets up a vm for the Undercloud installed with
the same base OS as the host. See the Note below to choose a different
OS:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To setup the undercloud vm with a base OS different from the host,
set the <tt class="docutils literal"><span class="pre">$NODE_DIST</span></tt> environment variable prior to running
<tt class="docutils literal"><span class="pre">instack-virt-setup</span></tt>:</p>
<div class="centos admonition">
<p class="first admonition-title">CentOS</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export NODE_DIST=centos7
</pre></div>
</div>
</div>
<div class="rhel last admonition">
<p class="first admonition-title">RHEL</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export NODE_DIST=rhel7
</pre></div>
</div>
</div>
</div>
</li>
<li><p class="first">Run the script to setup your virtual environment:</p>
</li>
</ol>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p>By default, the overcloud VMs will be created with 1 vCPU and 5120 MiB RAM and
the undercloud VM with 2 vCPU and 6144 MiB. To adjust
those values:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>export NODE_CPU=4
export NODE_MEM=16384
</pre></div>
</div>
<p>Note the settings above only influence the VMs created for overcloud
deployment.  If you want to change the values for the undercloud node:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export UNDERCLOUD_NODE_CPU=4
export UNDERCLOUD_NODE_MEM=16384
</pre></div>
</div>
</div>
<div class="rhel admonition">
<p class="first admonition-title">RHEL</p>
<p>Download the RHEL 7.1 cloud image or copy it over from a different
location, for example: <a class="reference external" href="https://access.redhat.com/downloads/content/69/ver=/rhel---7/7.1/x86_64/product-downloads">https://access.redhat.com/downloads/content/69/ver=/rhel&#8212;7/7.1/x86_64/product-downloads</a>,
and define the needed environment variables for RHEL 7.1 prior to
running <tt class="docutils literal"><span class="pre">instack-virt-setup</span></tt>:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export DIB_LOCAL_IMAGE=rhel-guest-image-7.1-20150224.0.x86_64.qcow2
</pre></div>
</div>
</div>
<div class="portal admonition">
<p class="first admonition-title">RHEL Portal Registration</p>
<p>To register the Undercloud vm to the Red Hat Portal define the following
variables:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export REG_METHOD=portal
export REG_USER=&quot;[your username]&quot;
export REG_PASSWORD=&quot;[your password]&quot;
# Find this with `sudo subscription-manager list --available`
export REG_POOL_ID=&quot;[pool id]&quot;
export REG_REPOS=&quot;rhel-7-server-rpms rhel-7-server-extras-rpms rhel-ha-for-rhel-7-server-rpms \
       rhel-7-server-optional-rpms rhel-7-server-openstack-6.0-rpms&quot;
</pre></div>
</div>
</div>
<div class="satellite admonition">
<p class="first admonition-title">RHEL Satellite Registration</p>
<p>To register the Undercloud vm to a Satellite define the following
variables. Only using an activation key is supported when registering
to Satellite, username/password is not supported for security reasons.
The activation key must enable the repos shown:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export REG_METHOD=satellite
# REG_SAT_URL should be in the format of:
# http://&lt;satellite-hostname&gt;
export REG_SAT_URL=&quot;[satellite url]&quot;
export REG_ORG=&quot;[satellite org]&quot;
# Activation key must enable these repos:
# rhel-7-server-rpms
# rhel-7-server-optional-rpms
# rhel-7-server-extras-rpms
# rhel-7-server-openstack-6.0-rpms
export REG_ACTIVATION_KEY=&quot;[activation key]&quot;
</pre></div>
</div>
</div>
<div class="ceph admonition">
<p class="first admonition-title">Ceph</p>
<p>To use Ceph you will need at least one additional virtual machine to be
provisioned as a Ceph OSD; set the <tt class="docutils literal"><span class="pre">NODE_COUNT</span></tt> variable to 3, from a
default of 2, so that the overcloud will have exactly one more:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export NODE_COUNT=3
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <tt class="docutils literal"><span class="pre">TESTENV_ARGS</span></tt> environment variable can be used to customize the
virtual environment configuration.  For example, it could be used to
enable additional networks as follows:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>export TESTENV_ARGS=&quot;--baremetal-bridge-names &#39;brbm brbm1 brbm2&#39;&quot;
</pre></div>
</div>
</div>
<div class="admonition note" id="there">
<p class="first admonition-title">Note</p>
<p>The <tt class="docutils literal"><span class="pre">LIBVIRT_VOL_POOL</span></tt> and <tt class="docutils literal"><span class="pre">LIBVIRT_VOL_POOL_TARGET</span></tt> environment
variables govern the name and location respectively for the storage
pool used by libvirt. The defaults are the &#8216;default&#8217; pool with
target <tt class="docutils literal"><span class="pre">/var/lib/libvirt/images/</span></tt>. These variables are useful if your
current partitioning scheme results in insufficient space for running
any useful number of vms (see the <a class="reference external" href="http://docs.openstack.org/developer/tripleo-docs/environments/virtual.html#minimum-system-requirements">Minimum Requirements</a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># you can check the space available to the default location like
df -h  /var/lib/libvirt/images

# If you wish to specify an alternative pool name:
export LIBVIRT_VOL_POOL=tripleo
# If you want to specify an alternative target
export LIBVIRT_VOL_POOL_TARGET=/home/vm_storage_pool
</pre></div>
</div>
<p class="last">If you don&#8217;t have a &#8216;default&#8217; pool defined at all, setting the target
is sufficient as the default will be created with your specified
target (and directories created as necessary). It isn&#8217;t possible to
change the target for an existing volume pool with this method, so if
you already have a &#8216;default&#8217; pool and cannot remove it, you should also
specify a new pool name to be created.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">instack</span><span class="o">-</span><span class="n">virt</span><span class="o">-</span><span class="n">setup</span>
</pre></div>
</div>
<p>If the script encounters problems, see
<a class="reference internal" href="../troubleshooting/troubleshooting-virt-setup.html"><em>Troubleshooting instack-virt-setup Failures</em></a>.</p>
</div></blockquote>
<p>When the script has completed successfully it will output the IP address of the
instack vm that has now been installed with a base OS.</p>
<p>Running <tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">virsh</span> <span class="pre">list</span> <span class="pre">--all</span></tt> <a class="footnote-reference" href="#id4" id="id2">[2]</a> will show you now have one virtual machine called
<em>instack</em> and 2 called <em>baremetal[0-1]</em>.</p>
<p>You can ssh to the instack vm as the root user:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ssh root@&lt;instack-vm-ip&gt;
</pre></div>
</div>
<p>The vm contains a <tt class="docutils literal"><span class="pre">stack</span></tt> user to be used for installing the undercloud. You
can <tt class="docutils literal"><span class="pre">su</span> <span class="pre">-</span> <span class="pre">stack</span></tt> to switch to the stack user account.</p>
<p>Continue with <a class="reference internal" href="../installation/installation.html"><em>Undercloud Installation</em></a>.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Note that some default partitioning schemes may not provide
enough space to the partition containing the default path for libvirt image
storage (/var/lib/libvirt/images). The easiest fix is to export the
LIBVIRT_VOL_POOL_TARGET and LIBVIRT_VOL_POOL parameters in your environment
prior to running instack-virt-setup above (see note <a class="reference internal" href="#there">there</a>).
Alternatively you can just customize the partition layout at the time of
install to provide at least 200 GB of space for that path.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>The libvirt virtual machines have been defined under the system
instance (qemu:///system). The user account executing these instructions
gets added to the libvirtd group which grants passwordless access to
the system instance. It does however require logging into a new shell (or
desktop environment session if wanting to use virt-manager) before this
change will be fully applied. To avoid having to re-login, you can use
<tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">virsh</span></tt>.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="baremetal-environment">
<h2>Baremetal Environment<a class="headerlink" href="#baremetal-environment" title="Permalink to this headline">¶</a></h2>
<p>TripleO can be used in an all baremetal environment. One machine will be
used for Undercloud, the others will be used for your Overcloud.</p>
<div class="section" id="id5">
<h3>Minimum System Requirements<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>To deploy a minimal TripleO cloud with TripleO you need the following baremetal
machines:</p>
<ul class="simple">
<li>1 Undercloud</li>
<li>1 Overcloud Controller</li>
<li>1 Overcloud Compute</li>
</ul>
<p>For each additional Overcloud role, such as Block Storage or Object Storage,
you need an additional baremetal machine.</p>
<p>The baremetal machines must meet the following minimum specifications:</p>
<ul class="simple">
<li>multi-core CPU</li>
<li>4 GB memory</li>
<li>60 GB free disk space</li>
</ul>
<p>TripleO is supporting only the following operating systems:</p>
<ul class="simple">
<li>RHEL 7.1 x86_64 or</li>
<li>CentOS 7 x86_64</li>
</ul>
</div>
<div class="section" id="preparing-the-baremetal-environment">
<h3>Preparing the Baremetal Environment<a class="headerlink" href="#preparing-the-baremetal-environment" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="networking">
<h3>Networking<a class="headerlink" href="#networking" title="Permalink to this headline">¶</a></h3>
<p>The overcloud nodes will be deployed from the undercloud machine and therefore the machines need to have have their network settings modified to allow for the overcloud nodes to be PXE boot&#8217;ed using the undercloud machine. As such, the setup requires that:</p>
<ul class="simple">
<li>All overcloud machines in the setup must support IPMI</li>
<li>A management provisioning network is setup for all of the overcloud machines.
One NIC from every machine needs to be in the same broadcast domain of the
provisioning network. In the tested environment, this required setting up a new
VLAN on the switch. Note that you should use the same NIC on each of the
overcloud machines ( for example: use the second NIC on each overcloud
machine). This is because during installation we will need to refer to that NIC
using a single name across all overcloud machines e.g. em2</li>
<li>The provisioning network NIC should not be the same NIC that you are using
for remote connectivity to the undercloud machine. During the undercloud
installation, a openvswitch bridge will be created for Neutron and the
provisioning NIC will be bridged to the openvswitch bridge. As such,
connectivity would be lost if the provisioning NIC was also used for remote
connectivity to the undercloud machine.</li>
<li>The overcloud machines can PXE boot off the NIC that is on the private VLAN.
In the tested environment, this required disabling network booting in the BIOS
for all NICs other than the one we wanted to boot and then ensuring that the
chosen NIC is at the top of the boot order (ahead of the local hard disk drive
and CD/DVD drives).</li>
<li>For each overcloud machine you have: the MAC address of the NIC that will PXE
boot on the provisioning network the IPMI information for the machine (i.e. IP
address of the IPMI NIC, IPMI username and password)</li>
</ul>
<p>Refer to the following diagram for more information</p>
<img alt="../_images/TripleO_Network_Diagram_.jpg" src="../_images/TripleO_Network_Diagram_.jpg" />
</div>
<div class="section" id="setting-up-the-undercloud-machine">
<h3>Setting Up The Undercloud Machine<a class="headerlink" href="#setting-up-the-undercloud-machine" title="Permalink to this headline">¶</a></h3>
<ol class="arabic">
<li><p class="first">Select a machine within the baremetal environment on which to install the
undercloud.</p>
</li>
<li><p class="first">Install RHEL 7.1 x86_64 or CentOS 7 x86_64 on this machine.</p>
</li>
<li><p class="first">If needed, create a non-root user with sudo access to use for installing the
Undercloud:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo useradd stack
sudo passwd stack  # specify a password
echo &quot;stack ALL=(root) NOPASSWD:ALL&quot; | sudo tee -a /etc/sudoers.d/stack
sudo chmod 0440 /etc/sudoers.d/stack
</pre></div>
</div>
</li>
</ol>
<div class="rhel admonition">
<p class="first admonition-title">RHEL</p>
<p>If using RHEL, register the Undercloud for package installations/updates.</p>
<div class="portal admonition">
<p class="first admonition-title">RHEL Portal Registration</p>
<p>Register the host machine using Subscription Management:</p>
<div class="last highlight-python"><div class="highlight"><pre><span></span>sudo subscription-manager register --username=&quot;[your username]&quot; --password=&quot;[your password]&quot;
# Find this with `subscription-manager list --available`
sudo subscription-manager attach --pool=&quot;[pool id]&quot;
# Verify repositories are available
sudo subscription-manager repos --list
# Enable repositories needed
sudo subscription-manager repos --enable=rhel-7-server-rpms \
     --enable=rhel-7-server-optional-rpms --enable=rhel-7-server-extras-rpms \
     --enable=rhel-7-server-openstack-6.0-rpms
</pre></div>
</div>
</div>
<div class="satellite last admonition">
<p class="first admonition-title">RHEL Satellite Registration</p>
<p>To register the host machine to a Satellite, the following repos must
be synchronized on the Satellite and enabled for registered systems:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">optional</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">extras</span><span class="o">-</span><span class="n">rpms</span>
<span class="n">rhel</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">openstack</span><span class="o">-</span><span class="mf">6.0</span><span class="o">-</span><span class="n">rpms</span>
</pre></div>
</div>
<p class="last">See the <a class="reference external" href="https://access.redhat.com/documentation/en-US/Red_Hat_Satellite/">Red Hat Satellite User Guide</a> for how to configure the system to
register with a Satellite server. It is suggested to use an activation
key that automatically enables the above repos for registered systems.</p>
</div>
</div>
</div>
<div class="section" id="configuration-files">
<h3>Configuration Files<a class="headerlink" href="#configuration-files" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="instackenv-json">
<span id="instackenv"></span><h3>instackenv.json<a class="headerlink" href="#instackenv-json" title="Permalink to this headline">¶</a></h3>
<p>Create a JSON file describing your Overcloud baremetal nodes, call it
<tt class="docutils literal"><span class="pre">instackenv.json</span></tt> and place in your home directory. The file should contain
a JSON object with the only field <tt class="docutils literal"><span class="pre">nodes</span></tt> containing list of node
descriptions.</p>
<p>Each node description should contains required fields:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pm_type</span></tt> - driver for Ironic nodes, see <a class="reference internal" href="#ironic-drivers">Ironic Drivers</a> for details</li>
<li><tt class="docutils literal"><span class="pre">pm_addr</span></tt> - node BMC IP address (hypervisor address in case of virtual
environment)</li>
<li><tt class="docutils literal"><span class="pre">pm_user</span></tt>, <tt class="docutils literal"><span class="pre">pm_password</span></tt> - node BMC credentials</li>
</ul>
<p>Some fields are optional if you&#8217;re going to use introspection later:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">mac</span></tt> - list of MAC addresses, optional for bare metal</li>
<li><tt class="docutils literal"><span class="pre">cpu</span></tt> - number of CPU&#8217;s in system</li>
<li><tt class="docutils literal"><span class="pre">arch</span></tt> - CPU architecture (common values are <tt class="docutils literal"><span class="pre">i386</span></tt> and <tt class="docutils literal"><span class="pre">x86_64</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">memory</span></tt> - memory size in MiB</li>
<li><tt class="docutils literal"><span class="pre">disk</span></tt> - hard driver size in GiB</li>
</ul>
<p>It is also possible (but optional) to set Ironic node capabilities directly
in the JSON file. This can be useful for assigning node profiles or setting
boot options at registration time:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">capabilities</span></tt> - Ironic node capabilities.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>&quot;capabilities&quot;: &quot;profile:compute,boot_option:local&quot;
</pre></div>
</div>
</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;pm_type&quot;</span><span class="p">:</span><span class="s2">&quot;pxe_ipmitool&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mac&quot;</span><span class="p">:[</span>
                <span class="s2">&quot;fa:16:3e:2a:0e:36&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;cpu&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;memory&quot;</span><span class="p">:</span><span class="s2">&quot;4096&quot;</span><span class="p">,</span>
            <span class="s2">&quot;disk&quot;</span><span class="p">:</span><span class="s2">&quot;40&quot;</span><span class="p">,</span>
            <span class="s2">&quot;arch&quot;</span><span class="p">:</span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_user&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_password&quot;</span><span class="p">:</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_addr&quot;</span><span class="p">:</span><span class="s2">&quot;10.0.0.8&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;pm_type&quot;</span><span class="p">:</span><span class="s2">&quot;pxe_ipmitool&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mac&quot;</span><span class="p">:[</span>
                <span class="s2">&quot;fa:16:3e:da:39:c9&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;cpu&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;memory&quot;</span><span class="p">:</span><span class="s2">&quot;4096&quot;</span><span class="p">,</span>
            <span class="s2">&quot;disk&quot;</span><span class="p">:</span><span class="s2">&quot;40&quot;</span><span class="p">,</span>
            <span class="s2">&quot;arch&quot;</span><span class="p">:</span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_user&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_password&quot;</span><span class="p">:</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_addr&quot;</span><span class="p">:</span><span class="s2">&quot;10.0.0.15&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;pm_type&quot;</span><span class="p">:</span><span class="s2">&quot;pxe_ipmitool&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mac&quot;</span><span class="p">:[</span>
                <span class="s2">&quot;fa:16:3e:51:9b:68&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;cpu&quot;</span><span class="p">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;memory&quot;</span><span class="p">:</span><span class="s2">&quot;4096&quot;</span><span class="p">,</span>
            <span class="s2">&quot;disk&quot;</span><span class="p">:</span><span class="s2">&quot;40&quot;</span><span class="p">,</span>
            <span class="s2">&quot;arch&quot;</span><span class="p">:</span><span class="s2">&quot;x86_64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_user&quot;</span><span class="p">:</span><span class="s2">&quot;admin&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_password&quot;</span><span class="p">:</span><span class="s2">&quot;password&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pm_addr&quot;</span><span class="p">:</span><span class="s2">&quot;10.0.0.16&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ironic-drivers">
<h3>Ironic Drivers<a class="headerlink" href="#ironic-drivers" title="Permalink to this headline">¶</a></h3>
<p>Ironic drivers provide various level of support for different hardware.
The most up-to-date information about Ironic drivers is at
<a class="reference external" href="http://docs.openstack.org/developer/ironic/deploy/drivers.html">http://docs.openstack.org/developer/ironic/deploy/drivers.html</a>, but note that
this page always targets Ironic git master, not the release we use.</p>
<p>There are 2 generic drivers:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pxe_ipmitool</span></tt> driver uses <a class="reference external" href="http://sourceforge.net/projects/ipmitool/">ipmitool</a> utility to manage a bare metal
node, and supports vast variety of hardware.</li>
<li><tt class="docutils literal"><span class="pre">pxe_ssh</span></tt> is a special driver for testing Ironic in the virtual
environment. This driver connects to the hypervisor to conduct management
operations on virtual nodes. In case of this driver, <tt class="docutils literal"><span class="pre">pm_addr</span></tt> is a
hypervisor address, <tt class="docutils literal"><span class="pre">pm_user</span></tt> is a SSH user name for accessing hypervisor,
<tt class="docutils literal"><span class="pre">pm_password</span></tt> is a private SSH key for accessing hypervisor. Note that
private key must not be encrypted.</li>
</ul>
<p>Ironic also provides specific drivers for some types of hardware:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pxe_ilo</span></tt> targets HP Proliant Gen 8 and Gen 9 systems, and is recommended
for these systems instead of <tt class="docutils literal"><span class="pre">pxe_ipmitool</span></tt>. Please refer to the <a class="reference external" href="http://docs.openstack.org/developer/ironic/drivers/ilo.html">current
iLO driver documentation</a> or <a class="reference external" href="https://wiki.openstack.org/wiki/Ironic/Drivers/iLODrivers/Kilo">detailed iLO documentation for Kilo version</a>.</li>
<li><tt class="docutils literal"><span class="pre">pxe_drac</span></tt> targets DELL 11G and newer systems, and is recommended for these
systems instead of <tt class="docutils literal"><span class="pre">pxe_ipmitool</span></tt>.</li>
</ul>
<p>There are also 2 testing drivers:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">fake_pxe</span></tt> provides stubs instead of real power and management operations.
When using this driver, you have to conduct power on and off operations,
and set the current boot device, yourself.</li>
<li><tt class="docutils literal"><span class="pre">fake</span></tt> provides stubs for every operation, so that Ironic does not touch
hardware at all.</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3>Table Of Contents</h3>
            <ul><li><a href="../index.html">Return to project home page</a></li></ul>
            <ul>
<li><a class="reference internal" href="#">Environment Setup</a><ul>
<li><a class="reference internal" href="#virtual-environment">Virtual Environment</a><ul>
<li><a class="reference internal" href="#minimum-system-requirements">Minimum System Requirements</a></li>
<li><a class="reference internal" href="#preparing-the-virtual-environment-automated">Preparing the Virtual Environment (Automated)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#baremetal-environment">Baremetal Environment</a><ul>
<li><a class="reference internal" href="#id5">Minimum System Requirements</a></li>
<li><a class="reference internal" href="#preparing-the-baremetal-environment">Preparing the Baremetal Environment</a></li>
<li><a class="reference internal" href="#networking">Networking</a></li>
<li><a class="reference internal" href="#setting-up-the-undercloud-machine">Setting Up The Undercloud Machine</a></li>
<li><a class="reference internal" href="#configuration-files">Configuration Files</a></li>
<li><a class="reference internal" href="#instackenv-json">instackenv.json</a></li>
<li><a class="reference internal" href="#ironic-drivers">Ironic Drivers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="../introduction/components.html"
                                  title="previous chapter">TripleO Components</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../installation/installation.html"
                                  title="next chapter">Undercloud Installation</a></p>
            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/michaelhenkel/contrail-tripleo-docu
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/environments/environments.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
  <div id="admonition_selector">
    <span class="trigger">Limit Environment Specific Content</span>

    <div class="content">
      <span class="title">Operating Systems</span>
      <ul>
        <li><input type="checkbox" id="centos" checked="checked"><label for="centos" title="Step that should only be run when using CentOS.">CentOS</label></li>
        <li><input type="checkbox" id="rhel" checked="checked"><label for="rhel" title="Step that should only be run when using RHEL.">RHEL</label></li>
      </ul>

      <span class="title">RHEL Registration Types</span>
      <ul>
        <li><input type="checkbox" id="portal" checked="checked"><label for="portal" title="Step that should only be run when registering to the Red Hat Portal.">Portal</label></li>
        <li><input type="checkbox" id="satellite" checked="checked"><label for="satellite" title="Step that should only be run when registering to Red Hat Satellite.">Satellite</label></li>
      </ul>

      <span class="title">Environments</span>
      <ul>
        <li><input type="checkbox" id="baremetal" checked="checked"><label for="baremetal" title="Step that should only be run when deploying to baremetal.">Baremetal</label></li>
        <li><input type="checkbox" id="virtual" checked="checked"><label for="virtual" title="Step that should only be run when deploying to virtual machines.">Virtual</label></li>
        <li><input type="checkbox" id="ssl" checked="checked"><label for="ssl" title="Step that should only be run when deploying with SSL OpenStack endpoints.">SSL</label></li>
        <li><input type="checkbox" id="selfsigned" checked="checked"><label for="selfsigned" title="Step that should only be run when deploying with SSL and a self-signed certificate.">Self-Signed SSL</label></li>
      </ul>

      <span class="title">Additional Overcloud Roles</span>
      <ul>
        <li><input type="checkbox" id="ceph" checked="checked"><label for="ceph" title="Step that should only be run when deploying Ceph for use by the Overcloud.">Ceph</label></li>
      </ul>

      <span class="title">Development options</span>
      <ul>
         <li><input type="checkbox" id="source" checked=""><label for="source"
            title="Step that should only be run when choosing to use some components directly from their git source code repositories instead of packages.">Install from source</label></li>
        <li><input type="checkbox" id="stable" checked=""><label for="stable"
            title="Step that should only be run when choosing to use components from their stable branches rather than using packages/source based on current master.">Install from stable branch</label></li>
      </ul>


    </div>
  </div>

  
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>

    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../installation/installation.html" title="Undercloud Installation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../introduction/components.html" title="TripleO Components"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">tripleo-docs 0.0.1.dev17 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2015, OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/tripleo-docs");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>