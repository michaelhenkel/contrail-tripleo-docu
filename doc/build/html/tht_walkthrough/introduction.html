<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; tripleo-docs 0.0.1.dev17 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tweaks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1.dev17',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/cookies.js"></script>
    <script type="text/javascript" src="../_static/expandable.js"></script>
    <script type="text/javascript" src="../_static/admonition_selector.js"></script>
    <script type="text/javascript" src="../_static/jquery.scrollTo.js"></script>
    <script type="text/javascript" src="../_static/jquery.nav.js"></script>
    <script type="text/javascript" src="../_static/menu.js"></script>
    <link rel="top" title="tripleo-docs 0.0.1.dev17 documentation" href="../index.html" /> 
  </head>
  <body>
  <div id="header">
    <h1 id="logo"><a href="http://www.openstack.org/">OpenStack</a></h1>
    <ul id="navigation">
      
      <li><a href="http://www.openstack.org/" title="Go to the Home page" class="link">Home</a></li>
      <li><a href="http://www.openstack.org/projects/" title="Go to the OpenStack Projects page">Projects</a></li>
      <li><a href="http://www.openstack.org/user-stories/" title="Go to the User Stories page" class="link">User Stories</a></li>
      <li><a href="http://www.openstack.org/community/" title="Go to the Community page" class="link">Community</a></li>
      <li><a href="http://www.openstack.org/blog/" title="Go to the OpenStack Blog">Blog</a></li>
      <li><a href="http://wiki.openstack.org/" title="Go to the OpenStack Wiki">Wiki</a></li>
      <li><a href="http://docs.openstack.org/" title="Go to OpenStack Documentation" class="current">Documentation</a></li>
      
    </ul>
  </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The initial scope of this tutorial is to create a brief walkthrough with some
guidelines and naming conventions for future modules and features aligned with
the composable roles architecture. Regarding the described example in this
tutorial, which leads to align a service implementation with the composable
roles approach, is important to notice that a similar approach would be
followed if a user needed to add an entirely new service to a tripleo deployment.</p>
<p>The first step will be to identify and isolate a functionality or feature that
needs to be aligned with the composable roles approach. For instance, by
checking <tt class="docutils literal"><span class="pre">tripleo-heat-templates/puppet/manifests/overcloud_controller.pp</span></tt>
and selecting an installed service (i.e. &#8216;include ::ntp&#8217;).</p>
<p>The puppet manifests used to configure services on overcloud nodes currently
reside in the tripleo-heat-templates repository, in <a class="reference external" href="https://github.com/openstack/tripleo-heat-templates/tree/3d01f650f18b9e4f1892a6d9aa17f1bfc99b5091/puppet/manifests">puppet/manifest</a>
In order to properly organize and structure the code, all
manifests will be re-defined in the puppet-tripleo repository, and adapted to
the <a href="#id1"><span class="problematic" id="id2">`composable services architecture`_</span></a></p>
<p>The use case for this example uses NTP as a service installed by default among
the OpenStack deployment. In this particular case, NTP is installed and
configured based on the code from puppet manifests:</p>
<p><tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_cephstorage.pp</span></tt>,
<tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_volume.pp</span></tt>,
<tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_object.pp</span></tt>,
<tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_compute.pp</span></tt>,
<tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_controller.pp</span></tt> and
<tt class="docutils literal"><span class="pre">puppet/manifests/overcloud_controller_pacemaker.pp</span></tt></p>
<p>Which means that NTP will be installed everywhere in the overcloud, so there is
no need to add more code. Instead we need to refactor the code from those files
in order move it to puppet-tripleo.</p>
<p>Also it is important to notice that the NTP puppet module is already included in
the repository tripleo-puppet-elements, so we can use the manifests from NTP in
any node from the overcloud.</p>
<p>In the case of needing a new third-party puppet module, it should be added in
tripleo-puppet-elements (installed by default in all nodes) and referenced from
a puppet manifest in puppet-tripleo.</p>
<p>This tutorial is divided into several steps, according to different changes
that need to be added to the structure of tripleo-heat-templates and
puppet-tripleo.</p>
<div class="section" id="repositories-referenced-in-this-guide">
<h2>Repositories referenced in this guide<a class="headerlink" href="#repositories-referenced-in-this-guide" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>tripleo-heat-templates: All the tripleo-heat-templates (aka THT) logic.</li>
<li>puppet-tripleo: Custom TripleO puppet manifests to deploy the overcloud.</li>
<li>tripleo-puppet-elements: third-party puppet modules. (Not used in this
tutorial, but needs to be used for adding additional puppet modules.)</li>
</ul>
</div>
<div class="section" id="gerrit-patches-used-in-this-example">
<h2>Gerrit patches used in this example<a class="headerlink" href="#gerrit-patches-used-in-this-example" title="Permalink to this headline">¶</a></h2>
<p>The gerrit patches used to describe this walkthrough are:</p>
<ul class="simple">
<li><a class="reference external" href="https://review.openstack.org/#/c/310421/">https://review.openstack.org/#/c/310421/</a> (tripleo-heat-templates)</li>
<li><a class="reference external" href="https://review.openstack.org/#/c/310725/">https://review.openstack.org/#/c/310725/</a> (puppet-tripleo)</li>
</ul>
</div>
<div class="section" id="changes-prerequisites">
<h2>Changes prerequisites<a class="headerlink" href="#changes-prerequisites" title="Permalink to this headline">¶</a></h2>
<p>The controller services are defined and configured via Heat resource chains. In
the proposed patch (<a class="reference external" href="https://review.openstack.org/#/c/259568">https://review.openstack.org/#/c/259568</a>) controller
services will be wired to a new Heat feature that allows it to dynamically include
a set of nested stacks representing individual services via a Heat resource
chain. The current example will use this interface to decompose the controller
role into isolated services.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Additional Heat features must be defined in order to apply the same behaviour
to other roles (compute, storage). Current work defined in:
<a class="reference external" href="https://etherpad.openstack.org/p/tripleo-composable-services">https://etherpad.openstack.org/p/tripleo-composable-services</a></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
<div class="sphinxsidebar">
    <div class="sphinxsidebarwrapper">
            <h3>Table Of Contents</h3>
            <ul><li><a href="../index.html">Return to project home page</a></li></ul>
            <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#repositories-referenced-in-this-guide">Repositories referenced in this guide</a></li>
<li><a class="reference internal" href="#gerrit-patches-used-in-this-example">Gerrit patches used in this example</a></li>
<li><a class="reference internal" href="#changes-prerequisites">Changes prerequisites</a></li>
</ul>
</li>
</ul>

            <h3>Project Source</h3>
            <ul class="this-page-menu">
              <li><a href="http://git.openstack.org/cgit/michaelhenkel/contrail-tripleo-docu
"
                     rel="nofollow">Project Source</a></li>
            </ul>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/tht_walkthrough/introduction.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
  <div id="admonition_selector">
    <span class="trigger">Limit Environment Specific Content</span>

    <div class="content">
      <span class="title">Operating Systems</span>
      <ul>
        <li><input type="checkbox" id="centos" checked="checked"><label for="centos" title="Step that should only be run when using CentOS.">CentOS</label></li>
        <li><input type="checkbox" id="rhel" checked="checked"><label for="rhel" title="Step that should only be run when using RHEL.">RHEL</label></li>
      </ul>

      <span class="title">RHEL Registration Types</span>
      <ul>
        <li><input type="checkbox" id="portal" checked="checked"><label for="portal" title="Step that should only be run when registering to the Red Hat Portal.">Portal</label></li>
        <li><input type="checkbox" id="satellite" checked="checked"><label for="satellite" title="Step that should only be run when registering to Red Hat Satellite.">Satellite</label></li>
      </ul>

      <span class="title">Environments</span>
      <ul>
        <li><input type="checkbox" id="baremetal" checked="checked"><label for="baremetal" title="Step that should only be run when deploying to baremetal.">Baremetal</label></li>
        <li><input type="checkbox" id="virtual" checked="checked"><label for="virtual" title="Step that should only be run when deploying to virtual machines.">Virtual</label></li>
        <li><input type="checkbox" id="ssl" checked="checked"><label for="ssl" title="Step that should only be run when deploying with SSL OpenStack endpoints.">SSL</label></li>
        <li><input type="checkbox" id="selfsigned" checked="checked"><label for="selfsigned" title="Step that should only be run when deploying with SSL and a self-signed certificate.">Self-Signed SSL</label></li>
      </ul>

      <span class="title">Additional Overcloud Roles</span>
      <ul>
        <li><input type="checkbox" id="ceph" checked="checked"><label for="ceph" title="Step that should only be run when deploying Ceph for use by the Overcloud.">Ceph</label></li>
      </ul>

      <span class="title">Development options</span>
      <ul>
         <li><input type="checkbox" id="source" checked=""><label for="source"
            title="Step that should only be run when choosing to use some components directly from their git source code repositories instead of packages.">Install from source</label></li>
        <li><input type="checkbox" id="stable" checked=""><label for="stable"
            title="Step that should only be run when choosing to use components from their stable branches rather than using packages/source based on current master.">Install from stable branch</label></li>
      </ul>


    </div>
  </div>

  
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>

    </div>
</div>

      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../index.html">tripleo-docs 0.0.1.dev17 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2015, OpenStack Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
//Tracking docs.openstack.org/developer/<projectname> only
//The URL is built from the project variable in conf.py
var pageTracker = _gat._getTracker("UA-17511903-1");
pageTracker._setCookiePath("/developer/tripleo-docs");
pageTracker._trackPageview();
} catch(err) {}</script>

  </body>
</html>